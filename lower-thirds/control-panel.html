<!DOCTYPE html>
<html lang="it">

<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>Overlay control panel</title>
  <link rel="stylesheet" href="../common/css/style-001.css">
  <script src="../common/js/jquery.js"></script>
  <script type="text/javascript" src="settings.js"></script>
</head>

<body style="background: var(--obs-background);">
  <nav class="navbar navbar-light" style="margin:0px; background-color:rgb(70,69,70); border-color:black; border-top-style:solid; border-width:thin; padding-bottom: 0%; padding-top: 0%;">
    <a class="navbar-brand" href="index.html">
      <img src="../common/images/back.png" width="30" height="30" class="d-inline-block align-top" alt="" loading="lazy">
      <span style="margin-left:8%; color:white;"><b>Overlay controller</b> - <span id="titolo">Lower Third 1</span></span>
    </a>
  </nav>
  <div id=alert style="margin-top:1em;"></div>
  <div class="lower-thirds-panel panel">
    <div class="static-panel-top">
      <div id="input">

      </div>
      <div class="d-flex justify-content-center">
        <button class="onethird" id="sender" onclick="function_send()">Mostra</button>
        <select class="form-control" id="animazione" style="width:40%; margin-right:2%;" onchange="animazione()">
          <option value="lower1">Lower 1</option>
          <option value="lower2">Lower 2</option>
          <option value="lower3">Lower 3</option>
          <option value="social1">Social 1</option>
        </select>
        <!--<div class="progress">
      <div id="progress" class="progress-bar" role="progressbar" style="width: 70%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
    </div><br>-->
        <div class="radio-position">
          <input type="radio" name="radio-group-position" id="position-left" checked="checked" /><label for="position-left">Left</label>
          <input type="radio" name="radio-group-position" id="position-right" /><label for="position-right">Right</label>
        </div>
        <div style="clear:both"></div>
      </div>
    </div>
    <div class="panel-bottom">
      <div>
        <br>
        <h3>Preimpostazioni</h3>
        <br>
        <div id="accordion">
          <script>
            let html = "";
            for (var key in persone) {
              html += `
                  <div><h5 class="mb-0">
                    <button class="btn btn-link collapsed grande" data-toggle="collapse" data-target="#${key}" aria-expanded="false" aria-controls="${key}">${key}</button>
                    </h5>
                  <div id="${key}" class="collapse" aria-labelledby="${key}" data-parent="#accordion">
                  <div class="card-body">
                    <ul id="predefined">
                      <div id="${key}j"></div>
                    </ul>
                  </div>
               </div></div><br>
`
              document.querySelector('#accordion').innerHTML = html;
            }
            for (var kay in persone) {
              let httml = "";
              persone[kay].forEach(function(element) {
                httml += `
            <li><div class="name">${element[0]}</div><div class="function">${element[1]}</div><div class="animation">${element[2]}</div></li>
`
                document.querySelector(`#${kay}j`).innerHTML = httml;
              });

            }
          </script>
        </div>
      </div>
      <br>
      <div>
        <h3>Colori</h3>
        <br>
        <div class="d-flex justify-content-center" id="btn_colors"></div>
        <div id="colori"></div>
        <div>

          <script>
            $("ul#predefined li").click(function() {
              cur_name = $(this).children('.name').text();
              cur_function = $(this).children('.function').text();
              cur_animazione = $(this).children('.animation').text();
              $("#animazione").val(cur_animazione);
              switch (cur_animazione) {
                case "lower1":
                  var lower1 = `<input id="lower-third1-name" maxlength="22" placeholder="Nome e cognome">
      		              <input id="lower-third1-function" maxlength="60" placeholder="Ruolo">`;
                  document.getElementById('input').innerHTML = lower1;
                  $("#lower-third1-name:text").val(cur_name);
                  $("#lower-third1-function:text").val(cur_function);
                  break;

                case "lower2":
                  var lower2 = `<input id="lower-third2-name" maxlength="40" placeholder="Nome e cognome">
        		              <input id="lower-third2-function" maxlength="50" placeholder="Ruolo">`;
                  document.getElementById('input').innerHTML = lower2;
                  $("#lower-third2-name:text").val(cur_name);
                  $("#lower-third2-function:text").val(cur_function);
                  break;

                case "lower3":
                  var lower3 = `<input id="lower-third3-name" maxlength="40" placeholder="Nome e cognome">
          		                  <input id="lower-third3-function" maxlength="50" placeholder="Ruolo">`;
                  document.getElementById('input').innerHTML = lower3;
                  $("#lower-third3-name:text").val(cur_name);
                  $("#lower-third3-function:text").val(cur_function);
                  break;

                case "social1":
                  var social1 = `<div><div class="d-flex justify-content-center">
		                      <input id="social1-tit1" maxlength="30" placeholder="Titolo 1" style="margin-right: 3%;">
		                      <input id="social1-tit2" maxlength="30" placeholder="Titolo 2">
                          </div>
                          <div class="d-flex justify-content-center">
                          <input id="social1-des1" maxlength="30" placeholder="1 descrizione" style="margin-right: 3%;">
                          <input id="social1-des2" maxlength="30" placeholder="2 descrizione" style="margin-right: 3%;">
		                      <input id="social1-des3" maxlength="30" placeholder="3 descrizione" style="margin-right: 3%;">
                          <input id="social1-des4" maxlength="30" placeholder="4 descrizione" style="margin-right: 3%;">
                          <input id="social1-des5" maxlength="30" placeholder="5 descrizione">`;
                  document.getElementById('input').innerHTML = social1;
                  cur_names = cur_name.split("|");
                  cur_functions = cur_function.split("|");
                  $("#social1-tit1:text").val(cur_names[0]);
                  $("#social1-tit2:text").val(cur_names[1]);
                  $("#social1-des1:text").val(cur_functions[0]);
                  $("#social1-des2:text").val(cur_functions[1]);
                  $("#social1-des3:text").val(cur_functions[2]);
                  $("#social1-des4:text").val(cur_functions[3]);
                  $("#social1-des5:text").val(cur_functions[4]);
                  break;


                default:
                  console.error("Se vedi questo errore, molto probabilmente hai modificato il valore di una delle opzioni nella scelta dell'animazione desiderata.");
                  var alert_what =
                    `<div class="alert alert-danger alert-dismissible fade show" role="alert" style="background-color: #f12c2c; border-style: none; border-radius: 0px;"><strong>COSA?</strong> Come hai fatto a far comparire questo banner?<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>`;
                  document.getElementById("alert").innerHTML = alert_what;
              };


            });

            document.body.onload = function() {
              //Gestione colori
              let btn_colors = "";
              let input_colors = "";
              for (var kiave in colori["lower1"]) {
                btn_colors += `<button id="${kiave}q" class="marg btn btn-link collapsed" data-toggle="collapse" data-target="#${kiave}" aria-expanded="false" aria-controls="${kiave}"></button>`;
                input_colors += `<div id="${kiave}" class="collapse" aria-labelledby="${kiave}" data-parent="#colori"><br>
                <h6 style="text-transform: uppercase;">${kiave}</h6>
                <form class="d-flex justify-content-center"><div class="form-row align-items-center"><div class="col">
                        <div class="input-group"><div class="input-group-prepend">
                        <div class="input-group-text">R</div></div>
                          <input type="number" class="form-control" disabled id="red${kiave}" maxlength="3" max="255" min="0">
                          </div></div><div class="col"><div class="input-group"><div class="input-group-prepend">
                          <div class="input-group-text">G</div></div>
                          <input type="number" class="form-control" disabled id="green${kiave}" maxlength="3" max="255" min="0">
                        </div></div><div class="col"><div class="input-group"><div class="input-group-prepend">
                            <div class="input-group-text">B</div></div>
                          <input type="number" class="form-control" disabled id="blue${kiave}" maxlength="3" max="255" min="0">
                        </div></div><div class="col-auto my-1">
                        <a href="settings.js" target="_blank" class="btn btn-info">Apri Opzioni</a></div></div>
                </form></div>`;
              };
              document.querySelector('#btn_colors').innerHTML = btn_colors;
              document.querySelector('#colori').innerHTML = input_colors;

              for (var chiave in colori["lower1"]) {
                colori["lower1"][chiave].forEach(function(tipo) {
                  document.getElementById(`red${chiave}`).setAttribute("value", colori["lower1"][chiave][0]);
                  document.getElementById(`green${chiave}`).setAttribute("value", colori["lower1"][chiave][1]);
                  document.getElementById(`blue${chiave}`).setAttribute("value", colori["lower1"][chiave][2]);
                  document.getElementById(`${chiave}q`).setAttribute("style", "background-color: rgb(" + colori["lower1"][chiave][0] + "," + colori["lower1"][chiave][1] + "," + colori["lower1"][chiave][2] + ");");
                })
              };

              document.getElementById('titolo').innerHTML = document.getElementById('animazione').value;
              var lower1 = `<input id="lower-third1-name" maxlength="22" placeholder="Nome e cognome">
                    <input id="lower-third1-function" maxlength="60" placeholder="Ruolo">`;
              document.getElementById('input').innerHTML = lower1;
            };

            var bc = new BroadcastChannel('obs-lower-thirds-channel');

            function animazione() {
              var animazione = document.getElementById('animazione').value;
              document.getElementById('titolo').innerHTML = animazione;

              //COLORI
              let btn_colors = "";
              let input_colors = "";
              for (var kiave in colori[animazione]) {
                btn_colors += `<button id="${kiave}q" class="marg btn btn-link collapsed" data-toggle="collapse" data-target="#${kiave}" aria-expanded="false" aria-controls="${kiave}"></button>`;
                input_colors += `<div id="${kiave}" class="collapse" aria-labelledby="${kiave}" data-parent="#colori"><br>
                <h6 style="text-transform: uppercase;">${kiave}</h6>
                <form class="d-flex justify-content-center"><div class="form-row align-items-center"><div class="col">
                        <div class="input-group"><div class="input-group-prepend">
                        <div class="input-group-text">R</div></div>
                          <input type="number" class="form-control" disabled id="red${kiave}" maxlength="3" max="255" min="0">
                          </div></div><div class="col"><div class="input-group"><div class="input-group-prepend">
                          <div class="input-group-text">G</div></div>
                          <input type="number" class="form-control" disabled id="green${kiave}" maxlength="3" max="255" min="0">
                        </div></div><div class="col"><div class="input-group"><div class="input-group-prepend">
                            <div class="input-group-text">B</div></div>
                          <input type="number" class="form-control" disabled id="blue${kiave}" maxlength="3" max="255" min="0">
                        </div></div><div class="col-auto my-1">
                        <a href="settings.js" target="_blank" class="btn btn-info">Apri Opzioni</a></div></div>
                </form></div>`;
              };
              document.querySelector('#btn_colors').innerHTML = btn_colors;
              document.querySelector('#colori').innerHTML = input_colors;

              for (var chiave in colori[animazione]) {
                colori[animazione][chiave].forEach(function(tipo) {
                  document.getElementById(`red${chiave}`).setAttribute("value", colori[animazione][chiave][0]);
                  document.getElementById(`green${chiave}`).setAttribute("value", colori[animazione][chiave][1]);
                  document.getElementById(`blue${chiave}`).setAttribute("value", colori[animazione][chiave][2]);
                  document.getElementById(`${chiave}q`).setAttribute("style", "background-color: rgb(" + colori[animazione][chiave][0] + "," + colori[animazione][chiave][1] + "," + colori[animazione][chiave][2] + ");");
                })
              };


              switch (animazione) {
                case "lower1":
                  var lower1 = `<input id="lower-third1-name" maxlength="22" placeholder="Nome e cognome">
      		              <input id="lower-third1-function" maxlength="60" placeholder="Ruolo">`;
                  document.getElementById('input').innerHTML = lower1;
                  break;

                case "lower2":
                  var lower2 = `<input id="lower-third2-name" maxlength="40" placeholder="Nome e cognome">
        		              <input id="lower-third2-function" maxlength="50" placeholder="Ruolo">`;
                  document.getElementById('input').innerHTML = lower2;
                  break;

                case "lower3":
                  var lower3 = `<input id="lower-third3-name" maxlength="18" placeholder="Nome e cognome">
          		                  <input id="lower-third3-function" maxlength="50" placeholder="Ruolo">`;
                  document.getElementById('input').innerHTML = lower3;
                  break;

                case "social1":
                  var social1 = `<div><div class="d-flex justify-content-center">
		                      <input id="social1-tit1" maxlength="30" placeholder="Titolo 1" style="margin-right: 3%;">
		                      <input id="social1-tit2" maxlength="30" placeholder="Titolo 2">
                          </div>
                          <div class="d-flex justify-content-center">
                          <input id="social1-des1" maxlength="30" placeholder="1 descrizione" style="margin-right: 3%;">
                          <input id="social1-des2" maxlength="30" placeholder="2 descrizione" style="margin-right: 3%;">
		                      <input id="social1-des3" maxlength="30" placeholder="3 descrizione" style="margin-right: 3%;">
                          <input id="social1-des4" maxlength="30" placeholder="4 descrizione" style="margin-right: 3%;">
                          <input id="social1-des5" maxlength="30" placeholder="5 descrizione">`;
                  document.getElementById('input').innerHTML = social1;
                  break;


                default:
                  console.error("Se vedi questo errore, molto probabilmente hai modificato il valore di una delle opzioni nella scelta dell'animazione desiderata.");
                  var alert_what =
                    `<div class="alert alert-danger alert-dismissible fade show" role="alert" style="background-color: #f12c2c; border-style: none; border-radius: 0px;"><strong>COSA?</strong> Come hai fatto a far comparire questo banner?<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>`;
                  document.getElementById("alert").innerHTML = alert_what;
              };
            };

            function function_send() {
              animazione = document.getElementById('animazione').value;
              var alert_empty =
                `<div class="alert alert-danger alert-dismissible fade show" role="alert" style="background-color: #f12c2c; border-style: none; border-radius: 0px;"><strong>ATTENZIONE!</strong> I campi indicati non posso essere vuoti durante l'animazione!<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>`;

              switch (animazione) {
                case "lower1":
                  name_to_send = $("#lower-third1-name:text").val();
                  function_to_send = $("#lower-third1-function:text").val();

                  if (document.getElementById("position-left").checked == true) {
                    position = "left"
                  };
                  if (document.getElementById("position-right").checked == true) {
                    position = "right"
                  };

                  if (name_to_send != "" && function_to_send != "") {
                    bc.postMessage(animazione + '|' + name_to_send + '|' + function_to_send + '|' + position); /* send */
                    console.log(animazione + '|' + name_to_send + '|' + function_to_send + '|' + position);
                  } else {
                    console.error("Nome e ruolo non possono essere vuoti durante l'animazione!");
                    document.getElementById("alert").innerHTML = alert_empty;
                  }
                  break;

                case "lower2":
                  name_to_send = $("#lower-third2-name:text").val();
                  function_to_send = $("#lower-third2-function:text").val();

                  if (document.getElementById("position-left").checked == true) {
                    position = "left"
                  };
                  if (document.getElementById("position-right").checked == true) {
                    position = "right"
                  };

                  if (name_to_send != "" && function_to_send != "") {
                    bc.postMessage(animazione + '|' + name_to_send + '|' + function_to_send + '|' + position); /* send */
                    console.log(animazione + '|' + name_to_send + '|' + function_to_send + '|' + position);
                  } else {
                    console.error("Nome e ruolo non possono essere vuoti durante l'animazione!");
                    document.getElementById("alert").innerHTML = alert_empty;
                  }
                  break;

                  case "lower3":
                    name_to_send = $("#lower-third3-name:text").val();
                    function_to_send = $("#lower-third3-function:text").val();

                    if (document.getElementById("position-left").checked == true) {
                      position = "left"
                    };
                    if (document.getElementById("position-right").checked == true) {
                      position = "right"
                    };

                    if (name_to_send != "" && function_to_send != "") {
                      bc.postMessage(animazione + '|' + name_to_send + '|' + function_to_send + '|' + position); /* send */
                      console.log(animazione + '|' + name_to_send + '|' + function_to_send + '|' + position);
                    } else {
                      console.error("Nome e ruolo non possono essere vuoti durante l'animazione!");
                      document.getElementById("alert").innerHTML = alert_empty;
                    }
                    break;

                case "social1":
                  social1_tit1 = $("#social1-tit1:text").val();
                  social1_tit2 = $("#social1-tit2:text").val();
                  social1_des1 = $("#social1-des1:text").val();
                  social1_des2 = $("#social1-des2:text").val();
                  social1_des3 = $("#social1-des3:text").val();
                  social1_des4 = $("#social1-des4:text").val();
                  social1_des5 = $("#social1-des5:text").val();

                  if (document.getElementById("position-left").checked == true) {
                    position = "left"
                  };
                  if (document.getElementById("position-right").checked == true) {
                    position = "right"
                  };

                  if (social1_tit1 != "" && social1_tit1 != "" && social1_des1 != "" && social1_des2 != "" && social1_des3 != "" && social1_des4 != "" && social1_des5 != "") {
                    bc.postMessage(animazione + '|' + social1_tit1 + '|' + social1_tit2 + '|' + social1_des1 + '|' + social1_des2 + '|' + social1_des3 + '|' + social1_des4 + '|' + social1_des5 + '|' + position); /* send */
                    console.log(animazione + '|' + social1_tit1 + '|' + social1_tit2 + '|' + social1_des1 + '|' + social1_des2 + '|' + social1_des3 + '|' + social1_des4 + '|' + social1_des5 + '|' + position);
                  } else {
                    console.error("I campi inidicati non possono essere vuoti non possono essere vuoti durante l'animazione!");
                    document.getElementById("alert").innerHTML = alert_empty;
                  }
                  break;

                default:
                  console.error("Se vedi questo errore, molto probabilmente hai modificato il valore di una delle opzioni nella scelta dell'animazione desiderata.");
                  var alert =
                    `<div class="alert alert-danger alert-dismissible fade show" role="alert" style="background-color: #f12c2c; border-style: none; border-radius: 0px;"><strong>COSA?</strong> Come hai fatto a far comparire questo banner?<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>`;
                  document.getElementById("alert").innerHTML = alert_what;
              }
            };

            function function_hide() {
              //bc.postMessage('|||animateOut'); /* send - only last parameter*/
            }
          </script>
          <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
          <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        </div>
      </div>
    </div>
  </div>
</body>

</html>
